# 邮政编码查询脚本

这是一个Python脚本项目，用于自动化查询Excel表格中地址对应的邮政编码。

## 🚀 功能特性

- 📊 **Excel文件处理** - 读取和写入Excel表格中的地址信息
- 🌐 **智能网页抓取** - 自动访问邮政编码查询网站
- 🔍 **批量查询处理** - 支持大量地址的批量查询
- 📝 **结果自动保存** - 将查询结果自动添加到Excel表格中
- 🚀 **多编码支持** - 支持包含多个邮政编码的地址处理

## 🛠️ 环境要求

- **Python**: 3.7+
- **操作系统**: Windows / macOS / Linux
- **浏览器**: Chrome（用于网页自动化）

## 📦 安装依赖

```bash
pip install -r requirements.txt
```

### 依赖包说明

- `pandas>=1.5.0` - Excel文件操作
- `selenium>=4.0.0` - 网页自动化
- `openpyxl>=3.0.0` - Excel文件读写
- `webdriver-manager>=3.8.0` - Chrome驱动管理

## 🎯 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 运行查询脚本（推荐高级版）

```bash
python advanced_postal_lookup.py
```

### 3. 按提示输入参数

```
请输入Excel文件路径: sample_addresses.xlsx
请输入地址列名: 地址（请输入地址名称，而不是序号）
请输入邮政编码输出列名 (默认为'邮政编码'): 
是否使用无头模式（不显示浏览器窗口）? (y/n，默认y): y
确认开始查询? (y/n): y
```

### 4. 查看结果

查询完成后，会生成 `sample_addresses_with_postal_codes.xlsx` 文件。

## 📊 使用示例

### 输入Excel格式

| 序号 | 地址 | 备注 |
|------|------|------|
| 1 | 北京市朝阳区建国门外大街1号 | 国贸大厦 |
| 2 | 上海市浦东新区陆家嘴环路1000号 | 上海中心 |
| 3 | 广州市天河区珠江新城花城大道85号 | 广州塔附近 |

### 输出Excel格式

| 序号 | 地址 | 备注 | 邮政编码 |
|------|------|------|----------|
| 1 | 北京市朝阳区建国门外大街1号 | 国贸大厦 | 100020 |
| 2 | 上海市浦东新区陆家嘴环路1000号 | 上海中心 | 200120 |
| 3 | 广州市天河区珠江新城花城大道85号 | 广州塔附近 | 510623 |

## 📝 支持的Excel格式

- `.xlsx` (推荐)
- `.xls`

## ⚠️ 注意事项

1. **网络连接**：确保能够正常访问查询网站
2. **文件备份**：建议在查询前备份原始Excel文件
3. **查询频率**：脚本内置延时，避免对目标网站造成过大压力
4. **Chrome浏览器**：首次运行会自动下载ChromeDriver
5. **日志文件**：查询过程会生成日志文件，便于问题排查

## 🔧 故障排除

### 依赖问题
```bash
pip install --upgrade pip
pip install -r requirements.txt
```

### Chrome驱动问题
删除已下载的驱动文件，重新运行脚本会自动下载最新版本。

### 网站访问问题
1. 检查网络连接
2. 重新启动浏览器
3. 查看日志文件了解详细错误信息

---

**作者**: Ances PioPio
**创建日期**: 2025年7月26日  
**版本**: 1.0.0
