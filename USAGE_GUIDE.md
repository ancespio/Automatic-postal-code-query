# 邮政编码查询脚本使用指南

## 项目概述

本项目提供了三个不同版本的邮政编码查询脚本，用于自动化查询Excel表格中地址对应的邮政编码。

## 文件说明

### 核心脚本文件

1. **`postal_code_lookup.py`** - 原始完整版脚本
   - 功能最全面，包含多种查询策略
   - 使用Selenium自动化浏览器操作
   - 适合需要完整功能的场景

2. **`simple_postal_lookup.py`** - 简化版脚本
   - 轻量级实现，主要使用API查询
   - 包含一些预设的城市邮政编码映射
   - 运行速度快，资源消耗少

3. **`advanced_postal_lookup.py`** - 高级版脚本 ⭐️ **推荐使用**
   - 针对目标网站优化的智能查询
   - 更好的错误处理和日志记录
   - 支持多种元素选择策略
   - 可选择有头/无头模式

### 辅助文件

- **`create_sample.py`** - 创建示例Excel文件
- **`requirements.txt`** - 项目依赖包列表
- **`sample_addresses.xlsx`** - 示例Excel文件（自动生成）

## 快速开始

### 1. 环境准备

确保已安装Python 3.7+，然后安装依赖包：

```bash
pip install -r requirements.txt
```

### 2. 创建测试数据

运行以下命令创建示例Excel文件：

```bash
python create_sample.py
```

### 3. 运行查询脚本

推荐使用高级版脚本：

```bash
python advanced_postal_lookup.py
```

按照提示输入：
- Excel文件路径（如：`sample_addresses.xlsx`）
- 地址列名（如：`地址`）
- 输出列名（默认：`邮政编码`）
- 是否使用无头模式（默认：是）

### 4. 查看结果

脚本执行完成后，会在同目录下生成带有邮政编码的新Excel文件：
- 原文件：`sample_addresses.xlsx`
- 结果文件：`sample_addresses_with_postal_codes.xlsx`

## VS Code 任务

项目配置了以下VS Code任务，可通过 `Ctrl+Shift+P` → `Tasks: Run Task` 运行：

1. **运行高级查询脚本** - 运行推荐的高级版脚本
2. **运行简化版查询脚本** - 运行轻量级版本
3. **运行邮政编码查询脚本** - 运行完整版脚本
4. **创建示例Excel文件** - 生成测试数据
5. **安装依赖包** - 安装所需的Python包

## 使用说明

### Excel文件要求

- 支持格式：`.xlsx`、`.xls`
- 必须包含地址列
- 地址列应包含详细的地址信息

### 输出格式

- 如果找到多个邮政编码，会用分号(`;`)分隔
- 如果未找到邮政编码，会显示"未找到"
- 原始数据不会被修改，结果保存在新文件中

### 注意事项

1. **网络连接**：确保网络连接正常，能够访问查询网站
2. **查询速度**：为避免对目标网站造成过大压力，脚本会在查询间添加延时
3. **Chrome浏览器**：高级版脚本需要Chrome浏览器，首次运行会自动下载ChromeDriver
4. **日志记录**：查询过程会记录在日志文件中，便于问题排查

## 故障排除

### 常见问题

1. **导入错误**：运行 `pip install -r requirements.txt` 安装依赖
2. **网站访问失败**：检查网络连接或尝试使用简化版脚本
3. **Chrome驱动问题**：删除下载的驱动文件，重新运行脚本自动下载
4. **查询结果为空**：检查网站是否正常访问，或查看日志文件了解详情

### 调试模式

运行高级版脚本时，选择非无头模式可以看到浏览器操作过程，便于调试。

## 技术架构

- **Python 3.7+**：主要编程语言
- **pandas**：Excel文件读写和数据处理
- **selenium**：网页自动化操作
- **webdriver-manager**：自动管理ChromeDriver
- **openpyxl**：Excel文件操作支持

## 许可证

本项目采用MIT许可证，可自由使用和修改。

## 联系支持

如有问题或建议，请通过以下方式联系：
- 查看项目日志文件
- 检查VS Code问题面板
- 参考项目文档和注释
